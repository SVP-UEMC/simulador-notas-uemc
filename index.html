<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Cálculo de Notas - Evaluación Continua</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Trebuchet MS', Arial, sans-serif;
            background-color: #eee9e5;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .main-title {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 22px;
            font-weight: bold;
        }

        .sub-title {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 18px;
        }

        .selection-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
        }

        .type-button {
            padding: 20px 30px;
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }

        .type-button.individual {
            background-color: #196049;
        }

        .type-button.grupal {
            background-color: #e03520;
        }

        .type-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .calculator {
            display: none;
            background-color: #eaeade;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        .type-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .type-badge {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 15px;
            color: white;
            font-size: 20px;
            font-weight: bold;
        }

        .type-badge.individual {
            background-color: #196049;
        }

        .type-badge.grupal {
            background-color: #e03520;
        }

        .convocatoria {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .convocatoria h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            font-size: 20px;
        }

        .activities-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .activity-pair {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #f9f9f9;
        }

        .activity-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .activity-label {
            font-weight: bold;
            min-width: 200px;
            color: #333;
        }

        .activity-input {
            width: 80px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 5px;
            text-align: center;
            font-size: 16px;
        }

        .activity-input:disabled {
            background-color: #e0e0e0;
            color: #666;
        }

        .peso-text {
            color: #666;
            font-size: 14px;
            min-width: 100px;
            text-align: right;
        }

        .calculation-info {
            background-color: #f0f8ff;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            font-size: 14px;
            color: #333;
            font-: italic;
        }

        .total-container {
            background-color: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
        }

        .total-label {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .total-value {
            font-size: 24px;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 8px;
            display: inline-block;
            min-width: 100px;
            background-color: #f0f8ff;
            color: #333;
            border: 1px solid #ccc;
        }

        .aprobado {
            background-color: #196049 !important;
            color: white !important;
        }

        .suspenso {
            background-color: #e03520 !important;
            color: white !important;
        }

        .message {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
        }

        .message.aprobado {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.suspenso {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .back-button {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .back-button:hover {
            background-color: #5a6268;
        }

        .pending-activities {
            color: white;
            font-weight: bold;
        }
    /*RESPONSIVE MOBILE*/
@media (max-width: 600px) {
    .container {
        padding: 10px !important;
        border-radius: 0 !important;
        box-shadow: none !important;
        max-width: 100vw !important;
    }
    .main-title, .sub-title {
        font-size: 16px !important;
        margin-bottom: 8px !important;
    }
    .selection-container {
        flex-direction: column !important;
        gap: 15px !important;
    }
    .type-button {
        font-size: 14px !important;
        min-width: unset !important;
        padding: 14px 10px !important;
        border-radius: 10px !important;
    }
    .type-badge {
        font-size: 15px !important;
        padding: 10px 8px !important;
        border-radius: 10px !important;
    }
    .calculator {
        padding: 10px !important;
    }
    .total-container {
        padding: 8px !important;
    }
    .activity-pair {
        padding: 8px !important;
    }
    .activity-label, .peso-text {
        font-size: 12px !important;
        min-width: 110px !important;
    }
    .activity-input {
        width: 55px !important;
        font-size: 14px !important;
        padding: 6px !important;
    }
    .total-label {
        font-size: 14px !important;
    }
    .total-value {
        font-size: 16px !important;
        min-width: 60px !important;
        padding: 6px 4px !important;
    }
    .back-button {
        font-size: 13px !important;
        padding: 7px 12px !important;
        border-radius: 4px !important;
    }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="main-title">GRADOS UEMC ONLINE</h1>
        <h2 class="sub-title">Simulador de Cálculo de Notas - Evaluación Continua</h2>

        <div id="selection" class="selection-container">
            <button class="type-button individual" onclick="selectType('individual')">
                Asignatura Individual
            </button>
            <button class="type-button grupal" onclick="selectType('grupal')">
                Asignatura Grupal
            </button>
        </div>

        <div id="calculator-individual" class="calculator">
            <button class="back-button" onclick="backToSelection()">← Volver a selección</button>

            <div class="type-header">
                <div class="type-badge individual">Asignatura Individual</div>
            </div>

            <div class="convocatoria">
                <h3>Convocatoria Ordinaria</h3>
                <div class="activities-container">
                    <div class="activity-pair">
                       <div class="activity-row">
                            <span class="activity-label">
                                Actividad 1 (Entrega)
                                <span class="peso-text">Peso: 30%</span>
                            </span>
                            <input ... >
                    </div>
                        <div class="activity-row">
                            <span class="activity-label">Actividad 2 (Defensa):</span>
                            <input type="text" class="activity-input" id="ind-ord-act2" 
                                   oninput="validateInput(this); calculateIndividual('ordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="calculation-info" id="ind-ord-info12"></div>
                    </div>

                    <div class="activity-pair">
                        <div class="activity-row">
                            <span class="activity-label">Actividad 3 (Entrega):</span>
                            <input type="text" class="activity-input" id="ind-ord-act3" 
                                   oninput="validateInput(this); calculateIndividual('ordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 30%</span>
                        </div>
                        <div class="activity-row">
                            <span class="activity-label">Actividad 4 (Defensa):</span>
                            <input type="text" class="activity-input" id="ind-ord-act4" 
                                   oninput="validateInput(this); calculateIndividual('ordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="calculation-info" id="ind-ord-info34"></div>
                    </div>
                </div>

                <div class="total-container">
                    <div class="total-label">Total Evaluación Continua - Ordinaria</div>
                    <div class="total-value" id="ind-ord-total">--</div>
                    <div class="message" id="ind-ord-message"></div>
                </div>
            </div>

            <div class="convocatoria">
                <h3>Convocatoria Extraordinaria</h3>
                <div class="activities-container">
                    <div class="activity-pair">
                        <div class="activity-row">
                            <span class="activity-label">Actividad 1 (Entrega):</span>
                            <input type="text" class="activity-input" id="ind-ext-act1" 
                                   oninput="validateInput(this); calculateIndividual('extraordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 30%</span>
                        </div>
                        <div class="activity-row">
                            <span class="activity-label">Actividad 2 (Defensa):</span>
                            <input type="text" class="activity-input" id="ind-ext-act2" 
                                   oninput="validateInput(this); calculateIndividual('extraordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="calculation-info" id="ind-ext-info12"></div>
                    </div>

                    <div class="activity-pair">
                        <div class="activity-row">
                            <span class="activity-label">Actividad 3 (Entrega):</span>
                            <input type="text" class="activity-input" id="ind-ext-act3" 
                                   oninput="validateInput(this); calculateIndividual('extraordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 30%</span>
                        </div>
                        <div class="activity-row">
                            <span class="activity-label">Actividad 4 (Defensa):</span>
                            <input type="text" class="activity-input" id="ind-ext-act4" 
                                   oninput="validateInput(this); calculateIndividual('extraordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="calculation-info" id="ind-ext-info34"></div>
                    </div>
                </div>

                <div class="total-container">
                    <div class="total-label">Total Evaluación Continua - Extraordinaria</div>
                    <div class="total-value" id="ind-ext-total">--</div>
                    <div class="message" id="ind-ext-message"></div>
                </div>
            </div>
        </div>

        <div id="calculator-grupal" class="calculator">
            <button class="back-button" onclick="backToSelection()">← Volver a selección</button>

            <div class="type-header">
                <div class="type-badge grupal">Asignatura Grupal</div>
            </div>

            <div class="convocatoria">
                <h3>Convocatoria Ordinaria</h3>
                <div class="activities-container">
                    <div class="activity-pair">
                        <div class="activity-row">
                            <span class="activity-label">Actividad 1 (Foro):</span>
                            <input type="text" class="activity-input" id="grp-ord-act1" 
                                   oninput="validateInput(this); calculateGrupal('ordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="activity-row">
                            <span class="activity-label">Actividad 2 (Defensa):</span>
                            <input type="text" class="activity-input" id="grp-ord-act2" 
                                   oninput="validateInput(this); calculateGrupal('ordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="calculation-info" id="grp-ord-info12"></div>
                    </div>

                    <div class="activity-pair">
                        <div class="activity-row">
                            <span class="activity-label">Actividad 3 (Entrega):</span>
                            <input type="text" class="activity-input" id="grp-ord-act3" 
                                   oninput="validateInput(this); calculateGrupal('ordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 40%</span>
                        </div>
                        <div class="activity-row">
                            <span class="activity-label">Actividad 4 (Defensa):</span>
                            <input type="text" class="activity-input" id="grp-ord-act4" 
                                   oninput="validateInput(this); calculateGrupal('ordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="calculation-info" id="grp-ord-info34"></div>
                    </div>
                </div>

                <div class="total-container">
                    <div class="total-label">Total Evaluación Continua - Ordinaria</div>
                    <div class="total-value" id="grp-ord-total">--</div>
                    <div class="message" id="grp-ord-message"></div>
                </div>
            </div>

            <div class="convocatoria">
                <h3>Convocatoria Extraordinaria</h3>
                <div class="activities-container">
                    <div class="activity-pair">
                        <div class="activity-row">
                            <span class="activity-label">Actividad 1 (Entrega):</span>
                            <input type="text" class="activity-input" id="grp-ext-act1" 
                                   oninput="validateInput(this); calculateGrupal('extraordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="activity-row">
                            <span class="activity-label">Actividad 2 (Defensa):</span>
                            <input type="text" class="activity-input" id="grp-ext-act2" 
                                   oninput="validateInput(this); calculateGrupal('extraordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="calculation-info" id="grp-ext-info12"></div>
                    </div>

                    <div class="activity-pair">
                        <div class="activity-row">
                            <span class="activity-label">Actividad 3 (Entrega):</span>
                            <input type="text" class="activity-input" id="grp-ext-act3" 
                                   oninput="validateInput(this); calculateGrupal('extraordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 40%</span>
                        </div>
                        <div class="activity-row">
                            <span class="activity-label">Actividad 4 (Defensa):</span>
                            <input type="text" class="activity-input" id="grp-ext-act4" 
                                   oninput="validateInput(this); calculateGrupal('extraordinaria')"
                                   placeholder="0.0">
                            <span class="peso-text">Peso: 20%</span>
                        </div>
                        <div class="calculation-info" id="grp-ext-info34"></div>
                    </div>
                </div>

                <div class="total-container">
                    <div class="total-label">Total Evaluación Continua - Extraordinaria</div>
                    <div class="total-value" id="grp-ext-total">--</div>
                    <div class="message" id="grp-ext-message"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Objeto para almacenar las notas de cada convocatoria
        let notasIndividual = {
            ordinaria: { parte1: null, parte2: null, total: null },
            extraordinaria: { parte1: null, parte2: null, total: null }
        };

        let notasGrupal = {
            ordinaria: { parte1: null, parte2: null, total: null },
            extraordinaria: { parte1: null, parte2: null, total: null }
        };

        // Función para validar entrada de números con un decimal máximo
        function validateInput(input) {
            let value = input.value;

            // Reemplazar coma por punto
            value = value.replace(',', '.');

            // Eliminar caracteres no válidos (solo números y punto)
            value = value.replace(/[^0-9.]/g, '');

            // Asegurar que solo haya un punto decimal
            const parts = value.split('.');
            if (parts.length > 2) {
                value = parts[0] + '.' + parts.slice(1).join('');
            }

            // Limitar a un decimal
            if (parts[1] && parts[1].length > 1) {
                value = parts[0] + '.' + parts[1].substring(0, 1);
            }

            // Convertir a número y validar rango
            const num = parseFloat(value);
            if (!isNaN(num) && num > 10) {
                value = '10.0';
            }

            // Actualizar el valor del input
            input.value = value;
        }

        // Función de redondeo personalizado (5 hacia arriba)
        function roundToOneDecimal(num) {
            return Math.round(num * 10) / 10;
        }

        function selectType(type) {
            document.getElementById('selection').style.display = 'none';
            if (type === 'individual') {
                document.getElementById('calculator-individual').style.display = 'block';
                initializeExtraordinaria('individual');
            } else {
                document.getElementById('calculator-grupal').style.display = 'block';
                initializeExtraordinaria('grupal');
            }
        }

        function backToSelection() {
            document.getElementById('selection').style.display = 'flex';
            document.getElementById('calculator-individual').style.display = 'none';
            document.getElementById('calculator-grupal').style.display = 'none';
            clearAllInputs();
        }

        function clearAllInputs() {
            const inputs = document.querySelectorAll('.activity-input');
            inputs.forEach(input => {
                input.value = '';
                input.disabled = false;
                input.style.backgroundColor = '';
            });

            const totals = document.querySelectorAll('.total-value');
            totals.forEach(total => {
                total.textContent = '--';
                total.className = 'total-value';
            });

            const messages = document.querySelectorAll('.message');
            messages.forEach(msg => msg.innerHTML = '');

            const infos = document.querySelectorAll('.calculation-info');
            infos.forEach(info => info.innerHTML = '');

            notasIndividual = {
                ordinaria: { parte1: null, parte2: null, total: null },
                extraordinaria: { parte1: null, parte2: null, total: null }
            };
            notasGrupal = {
                ordinaria: { parte1: null, parte2: null, total: null },
                extraordinaria: { parte1: null, parte2: null, total: null }
            };
        }

        function initializeExtraordinaria(type) {
            const prefix = type === 'individual' ? 'ind' : 'grp';
            const extInputs = [
                `${prefix}-ext-act1`, `${prefix}-ext-act2`, 
                `${prefix}-ext-act3`, `${prefix}-ext-act4`
            ];

            extInputs.forEach(id => {
                const input = document.getElementById(id);
                input.disabled = true;
                input.style.backgroundColor = '#e0e0e0';
            });

            document.getElementById(`${prefix}-ext-total`).className = 'total-value';
            document.getElementById(`${prefix}-ord-total`).className = 'total-value';
        }

        function calculatePairScore(entrega, defensa, pesoEntrega, pesoDefensa) {
            const entregaNum = parseFloat(entrega) || 0;
            const defensaNum = parseFloat(defensa) || 0;

            if (entrega === '' || defensa === '') {
                return { score: null, explanation: '' };
            }

            let score;
            let explanation;

            if (entregaNum >= 5 && defensaNum >= 4) {
                score = entregaNum * pesoEntrega + defensaNum * pesoDefensa;
                explanation = `Entrega ≥5 y Defensa ≥4: Se calcula promedio ponderado (${entregaNum} × ${pesoEntrega} + ${defensaNum} × ${pesoDefensa} = ${score.toFixed(1)})`;
            } else if (entregaNum < 5 && defensaNum >= 4) {
                score = entregaNum;
                explanation = `Entrega <5 y Defensa ≥4: Se toma la nota de entrega (${entregaNum})`;
            } else if (entregaNum >= 5 && defensaNum < 4) {
                score = defensaNum;
                explanation = `Entrega ≥5 y Defensa <4: Se toma la nota de defensa (${defensaNum})`;
            } else {
                score = entregaNum * pesoEntrega + defensaNum * pesoDefensa;
                explanation = `Entrega <5 y Defensa <4: Se calcula promedio ponderado (${entregaNum} × ${pesoEntrega} + ${defensaNum} × ${pesoDefensa} = ${score.toFixed(1)})`;
            }

            return { score: roundToOneDecimal(score), explanation: explanation };
        }

        function calculateIndividual(convocatoria) {
            const prefix = convocatoria === 'ordinaria' ? 'ind-ord' : 'ind-ext';

            const act1 = document.getElementById(`${prefix}-act1`).value;
            const act2 = document.getElementById(`${prefix}-act2`).value;
            const act3 = document.getElementById(`${prefix}-act3`).value;
            const act4 = document.getElementById(`${prefix}-act4`).value;

            // Calcular Parte 1 (Actividades 1+2)
            const parte1 = calculatePairScore(act1, act2, 0.6, 0.4);
            if (parte1.score !== null) {
                document.getElementById(`${prefix}-info12`).innerHTML = parte1.explanation;
                notasIndividual[convocatoria].parte1 = parte1.score;
            } else {
                document.getElementById(`${prefix}-info12`).innerHTML = '';
                notasIndividual[convocatoria].parte1 = null;
            }

            // Calcular Parte 2 (Actividades 3+4)
            const parte2 = calculatePairScore(act3, act4, 0.6, 0.4);
            if (parte2.score !== null) {
                document.getElementById(`${prefix}-info34`).innerHTML = parte2.explanation;
                notasIndividual[convocatoria].parte2 = parte2.score;
            } else {
                document.getElementById(`${prefix}-info34`).innerHTML = '';
                notasIndividual[convocatoria].parte2 = null;
            }

            // Calcular total: parte1 * 0.5 + parte2 * 0.5
            if (notasIndividual[convocatoria].parte1 !== null && notasIndividual[convocatoria].parte2 !== null) {
                const total = (notasIndividual[convocatoria].parte1 * 0.5 + notasIndividual[convocatoria].parte2 * 0.5);
                notasIndividual[convocatoria].total = roundToOneDecimal(total);

                const totalElement = document.getElementById(`${prefix}-total`);
                totalElement.textContent = notasIndividual[convocatoria].total.toFixed(1);

                if (notasIndividual[convocatoria].total >= 5) {
                    totalElement.className = 'total-value aprobado';
                } else {
                    totalElement.className = 'total-value suspenso';
                }

                updateMessage('individual', convocatoria);
            } else {
                const totalElement = document.getElementById(`${prefix}-total`);
                totalElement.textContent = '--';
                totalElement.className = 'total-value';
            }

            if (convocatoria === 'ordinaria') {
                updateExtraordinaria('individual');
            }
        }

        function calculateGrupal(convocatoria) {
            const prefix = convocatoria === 'ordinaria' ? 'grp-ord' : 'grp-ext';

            const act1 = document.getElementById(`${prefix}-act1`).value;
            const act2 = document.getElementById(`${prefix}-act2`).value;
            const act3 = document.getElementById(`${prefix}-act3`).value;
            const act4 = document.getElementById(`${prefix}-act4`).value;

            // Calcular Parte 1 (Actividades 1+2) - Para grupal, 50%-50%
            const parte1 = calculatePairScore(act1, act2, 0.5, 0.5);
            if (parte1.score !== null) {
                document.getElementById(`${prefix}-info12`).innerHTML = parte1.explanation;
                notasGrupal[convocatoria].parte1 = parte1.score;
            } else {
                document.getElementById(`${prefix}-info12`).innerHTML = '';
                notasGrupal[convocatoria].parte1 = null;
            }

            // Calcular Parte 2 (Actividades 3+4) - Para grupal, 66.67%-33.33%
            const parte2 = calculatePairScore(act3, act4, 0.6667, 0.3333);
            if (parte2.score !== null) {
                document.getElementById(`${prefix}-info34`).innerHTML = parte2.explanation;
                notasGrupal[convocatoria].parte2 = parte2.score;
            } else {
                document.getElementById(`${prefix}-info34`).innerHTML = '';
                notasGrupal[convocatoria].parte2 = null;
            }

            // Calcular total: parte1 * 0.5 + parte2 * 0.5
            if (notasGrupal[convocatoria].parte1 !== null && notasGrupal[convocatoria].parte2 !== null) {
                const total = (notasGrupal[convocatoria].parte1 * 0.5 + notasGrupal[convocatoria].parte2 * 0.5);
                notasGrupal[convocatoria].total = roundToOneDecimal(total);

                const totalElement = document.getElementById(`${prefix}-total`);
                totalElement.textContent = notasGrupal[convocatoria].total.toFixed(1);

                if (notasGrupal[convocatoria].total >= 5) {
                    totalElement.className = 'total-value aprobado';
                } else {
                    totalElement.className = 'total-value suspenso';
                }

                updateMessage('grupal', convocatoria);
            } else {
                const totalElement = document.getElementById(`${prefix}-total`);
                totalElement.textContent = '--';
                totalElement.className = 'total-value';
            }

            if (convocatoria === 'ordinaria') {
                updateExtraordinaria('grupal');
            }
        }

        function updateMessage(type, convocatoria) {
            const prefix = type === 'individual' ? 'ind' : 'grp';
            const convPrefix = convocatoria === 'ordinaria' ? 'ord' : 'ext';
            const messageElement = document.getElementById(`${prefix}-${convPrefix}-message`);
            const notas = type === 'individual' ? notasIndividual : notasGrupal;

            if (notas[convocatoria].total >= 5) {
                messageElement.innerHTML = 'Evaluación continua aprobada';
                messageElement.className = 'message aprobado';
            } else {
                let pendingActivities = [];

                if (convocatoria === 'ordinaria') {
                    if (notas.ordinaria.parte1 < 5) {
                        pendingActivities.push('Actividades 1 y 2');
                    }
                    if (notas.ordinaria.parte2 < 5) {
                        pendingActivities.push('Actividades 3 y 4');
                    }

                    messageElement.innerHTML = `Evaluación continua suspensa. Debes realizar las siguientes actividades en convocatoria Extraordinaria: <span class="pending-activities">${pendingActivities.join(', ')}</span>`;
                } else {
                    messageElement.innerHTML = 'Evaluación continua suspensa';
                }
                messageElement.className = 'message suspenso';
            }
        }

        function updateExtraordinaria(type) {
            const prefix = type === 'individual' ? 'ind' : 'grp';
            const notas = type === 'individual' ? notasIndividual : notasGrupal;

            if (notas.ordinaria.total === null) return;

            // Si apruebas en ordinaria, no necesitas extraordinaria
            if (notas.ordinaria.total >= 5) {
                const extInputs = [`${prefix}-ext-act1`, `${prefix}-ext-act2`, `${prefix}-ext-act3`, `${prefix}-ext-act4`];
                extInputs.forEach(id => {
                    const input = document.getElementById(id);
                    input.disabled = true;
                    input.style.backgroundColor = '#e0e0e0';
                    input.value = '';
                });

                const totalElement = document.getElementById(`${prefix}-ext-total`);
                totalElement.textContent = notas.ordinaria.total.toFixed(1);
                totalElement.className = 'total-value aprobado';

                const messageElement = document.getElementById(`${prefix}-ext-message`);
                messageElement.innerHTML = 'Evaluación continua aprobada (nota de ordinaria)';
                messageElement.className = 'message aprobado';

                return;
            }

            // Gestionar partes aprobadas/suspensas en extraordinaria

            // Parte 1: Si aprobaste la parte 1 en ordinaria
            if (notas.ordinaria.parte1 >= 5) {
                // Bloquear campos y mostrar nota
                document.getElementById(`${prefix}-ext-act1`).disabled = true;
                document.getElementById(`${prefix}-ext-act1`).style.backgroundColor = '#e0e0e0';
                document.getElementById(`${prefix}-ext-act1`).value = notas.ordinaria.parte1.toFixed(1);

                document.getElementById(`${prefix}-ext-act2`).disabled = true;
                document.getElementById(`${prefix}-ext-act2`).style.backgroundColor = '#e0e0e0';
                document.getElementById(`${prefix}-ext-act2`).value = notas.ordinaria.parte1.toFixed(1);

                // Usar la nota de ordinaria para esta parte
                notas.extraordinaria.parte1 = notas.ordinaria.parte1;
                document.getElementById(`${prefix}-ext-info12`).innerHTML = `Parte 1 aprobada en ordinaria: ${notas.ordinaria.parte1.toFixed(1)}`;
            } else {
                // Habilitar actividades 1 y 2
                document.getElementById(`${prefix}-ext-act1`).disabled = false;
                document.getElementById(`${prefix}-ext-act1`).style.backgroundColor = '';

                document.getElementById(`${prefix}-ext-act2`).disabled = false;
                document.getElementById(`${prefix}-ext-act2`).style.backgroundColor = '';
            }

            // Parte 2: Si aprobaste la parte 2 en ordinaria
            if (notas.ordinaria.parte2 >= 5) {
                // Bloquear campos y mostrar nota
                document.getElementById(`${prefix}-ext-act3`).disabled = true;
                document.getElementById(`${prefix}-ext-act3`).style.backgroundColor = '#e0e0e0';
                document.getElementById(`${prefix}-ext-act3`).value = notas.ordinaria.parte2.toFixed(1);

                document.getElementById(`${prefix}-ext-act4`).disabled = true;
                document.getElementById(`${prefix}-ext-act4`).style.backgroundColor = '#e0e0e0';
                document.getElementById(`${prefix}-ext-act4`).value = notas.ordinaria.parte2.toFixed(1);

                // Usar la nota de ordinaria para esta parte
                notas.extraordinaria.parte2 = notas.ordinaria.parte2;
                document.getElementById(`${prefix}-ext-info34`).innerHTML = `Parte 2 aprobada en ordinaria: ${notas.ordinaria.parte2.toFixed(1)}`;
            } else {
                // Habilitar actividades 3 y 4
                document.getElementById(`${prefix}-ext-act3`).disabled = false;
                document.getElementById(`${prefix}-ext-act3`).style.backgroundColor = '';

                document.getElementById(`${prefix}-ext-act4`).disabled = false;
                document.getElementById(`${prefix}-ext-act4`).style.backgroundColor = '';
            }

            // Calcular total de extraordinaria si tenemos ambas partes
            if (notas.extraordinaria.parte1 !== null && notas.extraordinaria.parte2 !== null) {
                const total = (notas.extraordinaria.parte1 * 0.5 + notas.extraordinaria.parte2 * 0.5);
                notas.extraordinaria.total = roundToOneDecimal(total);

                const totalElementExt = document.getElementById(`${prefix}-ext-total`);
                totalElementExt.textContent = notas.extraordinaria.total.toFixed(1);

                if (notas.extraordinaria.total >= 5) {
                    totalElementExt.className = 'total-value aprobado';
                } else {
                    totalElementExt.className = 'total-value suspenso';
                }

                updateMessage(type, 'extraordinaria');
            } else {
                // Resetear el total de extraordinaria a estado inicial
                const totalElementExt = document.getElementById(`${prefix}-ext-total`);
                totalElementExt.textContent = '--';
                totalElementExt.className = 'total-value';
            }
        }
    </script>
</body>
</html>
